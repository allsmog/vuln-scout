---
name: report
description: Generate a findings report from the whitebox audit
argument-hint: "[output_file]"
allowed-tools:
  - Read
  - Write
  - Glob
  - Task
---

# Generate Findings Report

Create a comprehensive markdown report of all findings from the whitebox penetration test.

## Report Structure

Generate a report with the following sections:

### 1. Executive Summary

```markdown
# Whitebox Penetration Test Report

**Target**: [Application Name]
**Date**: [Current Date]
**Tester**: [If known]

## Executive Summary

This report presents the findings from a whitebox penetration test conducted on [target].

### Risk Summary

| Severity | Count |
|----------|-------|
| Critical | X     |
| High     | X     |
| Medium   | X     |
| Low      | X     |
| Info     | X     |

### Key Findings

1. [Most critical finding summary]
2. [Second most critical finding summary]
3. [Third most critical finding summary]
```

### 2. Methodology

```markdown
## Methodology

This assessment followed the 4-phase whitebox pentesting methodology:

1. **Code Review**: Static analysis to identify dangerous functions and prioritize targets
2. **Local Testing**: Dynamic analysis to confirm vulnerabilities
3. **Proof of Concept**: Development of working exploits
4. **Remediation**: Specific patches and secure coding recommendations

### Tools Used

- Source code analysis (manual review)
- Pattern matching for dangerous functions
- Data flow tracing
```

### 3. Detailed Findings

For each finding:

```markdown
## Finding [N]: [Title]

**ID**: WB-[YEAR]-[NUM]
**Severity**: Critical/High/Medium/Low/Info
**CVSS Score**: [If applicable]
**CWE**: [CWE-XXX]
**Status**: Confirmed/Suspected

### Location

- **File**: `path/to/vulnerable/file.ext`
- **Line**: XXX
- **Function**: `vulnerable_function()`

### Description

[Detailed description of the vulnerability]

### Technical Details

[Code snippets, data flow analysis]

### Impact

[What an attacker can achieve]

### Proof of Concept

[Steps to reproduce or PoC script reference]

### Remediation

**Immediate**: [Quick fix]

**Long-term**: [Proper solution]

**Code Example**:
```[language]
// Before (vulnerable)
[vulnerable code]

// After (secure)
[secure code]
```

### References

- [Relevant documentation]
- [CWE link]
- [OWASP reference]
```

### 4. Remediation Summary

```markdown
## Remediation Summary

### Priority Actions

1. **Critical**: [Action for critical findings]
2. **High**: [Action for high findings]

### Secure Coding Recommendations

- [General recommendation 1]
- [General recommendation 2]

### Timeline Recommendation

| Priority | Remediation Window |
|----------|-------------------|
| Critical | Immediate (24-48 hours) |
| High | Within 1 week |
| Medium | Within 1 month |
| Low | Next release cycle |
```

### 5. Appendices

```markdown
## Appendix A: Full Sink List

[Complete list of identified dangerous functions]

## Appendix B: Files Reviewed

[List of files analyzed]

## Appendix C: Tools and Techniques

[Detailed methodology notes]
```

## Output

If output_file argument provided:
- Write report to specified file

If no output_file:
- Output report to conversation
- Suggest saving to `whitebox-report-[date].md`

## Notes

- Include all findings from the audit session
- Sort findings by severity (Critical first)
- Include code examples for all recommendations
- Reference specific lines in the codebase
- Make report actionable for developers

---

## Agent Integration

### Patch Advisor Agent

For generating detailed remediation for each finding:

```
Use Task tool with:
  subagent_type: "whitebox-pentest:patch-advisor"
  prompt: |
    Generate remediation for report:
    - Finding: [vulnerability type and location]
    - Code: [vulnerable code snippet]
    - Framework: [language/framework]
    Output: Specific code fix with explanation
```

This can be called for each CRITICAL/HIGH finding to generate actionable fixes in the report.
