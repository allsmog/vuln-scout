---
name: poc-safety-check
description: Safety confirmation before PoC development begins
event: PreToolUse
match_tool: Write
---

# PoC Safety Check Hook

When writing files that appear to be exploit scripts, confirm authorization and safety.

## Detection Patterns

Check if the file being written matches exploit patterns:
- Filename contains: `exploit`, `poc`, `payload`, `attack`, `pwn`
- File path contains: `exploits/`, `poc/`, `payloads/`
- Content contains: exploit class patterns, shell commands, injection payloads

## Safety Prompt

If exploit patterns detected, prepend this message:

```
⚠️ **Security Testing Authorization Check**

You're about to create/modify what appears to be an exploit script.

Before proceeding, please confirm:
1. [ ] You have explicit authorization to test the target system
2. [ ] This is being developed for a legitimate security assessment
3. [ ] The script includes appropriate safety controls (--dry-run, --check options)
4. [ ] You understand the potential impact of running this code

**Reminder:** This tool is intended for:
- Authorized penetration testing
- Security research
- CTF competitions
- Educational purposes

Proceeding with exploit development...
```

## Exploit Script Standards

When creating exploit scripts, ensure they include:

1. **Header Documentation:**
   ```python
   """
   Exploit: [Application Name] [Vulnerability Type]
   Target: [Endpoint/Function]
   Author: [Your Name]
   Date: [Date]
   Authorization: [Reference to authorization document]
   """
   ```

2. **Safety Features:**
   - `--check` flag for safe verification only
   - `--dry-run` flag to simulate without executing
   - Confirmation prompts for destructive actions
   - Cleanup functionality

3. **Non-Destructive Defaults:**
   - Default to read-only operations where possible
   - Require explicit flags for data modification
   - Include verification before exploitation
